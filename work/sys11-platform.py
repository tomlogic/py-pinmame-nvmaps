#!/usr/bin/env python3

"""
Change platform file of System 9 and System 11 games to match ROM size.
"""

import json
import os

# List generated by grepping s11game.c for ROMSTART and then some search/replace
update = {
    'sshtl_l7': 'williams-system11-16K',
    'sshtl_l3': 'williams-system11-16K',
    'sorcr_l1': 'williams-system11-12K',
    'sorcr_l2': 'williams-system11-12K',
    'comet_l4': 'williams-system11-16K',
    'comet_l5': 'williams-system11-16K',
    'hs_l4': 'williams-system11-40K',
    'hs_l3': 'williams-system11-40K',
    'hs_p4g': 'williams-system11-48K',
    'hs_l4c': 'williams-system11-40K',
    'hs_l4c': 'williams-system11-40K',
    'grand_l4': 'williams-system11-40K',
    'grand_l3': 'williams-system11-40K',
    'grand_l1': 'williams-system11-40K',
    'rdkng_l4': 'williams-system11-48K',
    'rdkng_l1': 'williams-system11-48K',
    'rdkng_l2': 'williams-system11-48K',
    'rdkng_l3': 'williams-system11-48K',
    'pb_l5': 'williams-system11-48K',
    'pb_l5h': 'williams-system11-48K',
    'pb_l3': 'williams-system11-48K',
    'pb_l2': 'williams-system11-48K',
    'pb_l1': 'williams-system11-48K',
    'pb_p4': 'williams-system11-48K',
    'pb_j1': 'williams-system11-48K',
    'pb_j2': 'williams-system11-48K',
    'pb_j3': 'williams-system11-48K',
    'f14_p3': 'williams-system11-48K',
    'f14_p4': 'williams-system11-48K',
    'f14_l1': 'williams-system11-48K',
    'f14_p5': 'williams-system11-48K',
    'fire_l3': 'williams-system11-48K',
    'fire_l2': 'williams-system11-48K',
    'bguns_l8': 'williams-system11-48K',
    'bguns_l7': 'williams-system11-48K',
    'bguns_la': 'williams-system11-48K',
    'bguns_lac': 'williams-system11-48K',
    'bguns_p1_': 'williams-system11-48K',
    'spstn_l5': 'williams-system11-48K',
    'cycln_l5': 'williams-system11-48K',
    'cycln_l4': 'williams-system11-48K',
    'cycln_l1': 'williams-system11-48K',
    'bnzai_l3': 'williams-system11-48K',
    'bnzai_t3': 'williams-system11-48K',
    'bnzai_g3': 'williams-system11-48K',
    'bnzai_l1': 'williams-system11-48K',
    'bnzai_pa': 'williams-system11-48K',
    'swrds_l2': 'williams-system11-48K',
    'swrds_lg2': 'williams-system11-48K',
    'swrds_l1': 'williams-system11-48K',
    'taxi_l4': 'williams-system11-48K',
    'taxi_l5c': 'williams-system11-48K',
    'taxi_l5cm': 'williams-system11-48K',
    'taxi_l3': 'williams-system11-48K',
    'taxi_lu1': 'williams-system11-48K',
    'taxi_lg1': 'williams-system11-48K',
    'taxi_p5': 'williams-system11-48K',
    'jokrz_l6': 'williams-system11-48K',
    'jokrz_l3': 'williams-system11-48K',
    'jokrz_g4': 'williams-system11-48K',
    'esha_pr4': 'williams-system11-48K',
    'esha_la3': 'williams-system11-48K',
    'esha_l4c': 'williams-system11-48K',
    'esha_ma3': 'williams-system11-48K',
    'esha_lg1': 'williams-system11-48K',
    'esha_lg2': 'williams-system11-48K',
    'esha_la1': 'williams-system11-48K',
    'esha_pa4': 'williams-system11-48K',
    'esha_pa1': 'williams-system11-48K',
    'bk2k_l4': 'williams-system11-48K',
    'bk2k_lg1': 'williams-system11-48K',
    'bk2k_lg3': 'williams-system11-48K',
    'bk2k_pu1': 'williams-system11-48K',
    'bk2k_la2': 'williams-system11-48K',
    'bk2k_pa7': 'williams-system11-48K',
    'bk2k_pa5': 'williams-system11-48K',
    'bk2k_pf1': 'williams-system11-48K',
    'polic_l4': 'williams-system11-48K',
    'polic_g4': 'williams-system11-48K',
    'polic_l3': 'williams-system11-48K',
    'polic_l2': 'williams-system11-48K',
    'tsptr_l3': 'williams-system11-48K',
    'tsptr_lu3': 'williams-system11-48K',
    'tsptr_l1': 'williams-system11-48K',
    'bcats_l5': 'williams-system11-48K',
    'bcats_f1': 'williams-system11-48K',
    'bcats_l2': 'williams-system11-48K',
    'bcats_g4': 'williams-system11-48K',
    'bcats_tcm': 'williams-system11-48K',
    'bcats_tcm12': 'williams-system11-48K',
    'bcats_tcm13': 'williams-system11-48K',
    'mousn_l4': 'williams-system11-48K',
    'mousn_l4c': 'williams-system11-48K',
    'mousn_l4c': 'williams-system11-48K',
    'mousn_l4c': 'williams-system11-48K',
    'mousn_l1': 'williams-system11-48K',
    'mousn_lu': 'williams-system11-48K',
    'whirl_l3': 'williams-system11-48K',
    'whirl_l2': 'williams-system11-48K',
    'whirl_g1': 'williams-system11-48K',
    'whirl_g2': 'williams-system11-48K',
    'whirl_g3': 'williams-system11-48K',
    'gs_la3': 'williams-system11-48K',
    'gs_lu4': 'williams-system11-48K',
    'gs_lu3': 'williams-system11-48K',
    'gs_lg6': 'williams-system11-48K',
    'rollr_l2': 'williams-system11-48K',
    'rollr_l2c': 'williams-system11-48K',
    'rollr_ex': 'williams-system11-48K',
    'rollr_l1': 'williams-system11-48K',
    'rollr_e1': 'williams-system11-48K',
    'rollr_p2': 'williams-system11-48K',
    'rollr_l3': 'williams-system11-48K',
    'rollr_g3': 'williams-system11-48K',
    'rollr_d2': 'williams-system11-48K',
    'rollr_f2': 'williams-system11-48K',
    'rollr_f3': 'williams-system11-48K',
    'pool_l7': 'williams-system11-48K',
    'pool_l5': 'williams-system11-48K',
    'pool_l6': 'williams-system11-48K',
    'pool_le2': 'williams-system11-48K',
    'pool_p7': 'williams-system11-48K',
    'pool_l7c': 'williams-system11-48K',
    'pool_l7c': 'williams-system11-48K',
    'diner_l4': 'williams-system11-48K',
    'diner_l3': 'williams-system11-48K',
    'diner_f2': 'williams-system11-48K',
    'diner_g2': 'williams-system11-48K',
    'diner_l2': 'williams-system11-48K',
    'diner_l1': 'williams-system11-48K',
    'diner_p0': 'williams-system11-48K',
    'radcl_l1': 'williams-system11-48K',
    'radcl_g1': 'williams-system11-48K',
    'radcl_p3': 'williams-system11-48K',
    'radcl_l1c': 'williams-system11-48K',
    'radcl_l1c': 'williams-system11-48K',
    'strax_p7': 'williams-system11-48K',
    'rvrbt_l3': 'williams-system11-48K',
    'rvrbt_p7': 'williams-system11-48K',
    'bbnny_l2': 'williams-system11-48K',
    'bbnny_lu': 'williams-system11-48K',
    'bbnny_lg': 'williams-system11-48K',
}

MAPS_ROOT = os.path.join(os.path.dirname(__file__), '..', 'maps')

with open(os.path.join(MAPS_ROOT, 'index.json')) as f:
    index_json = json.load(f)
for rom, map_file in index_json.items():
    platform = update.get(rom)
    if platform:
        with open(os.path.join(MAPS_ROOT, map_file)) as f:
            map_json = json.load(f)
        if map_json['_metadata']['platform'] != platform:
            map_json['_metadata']['platform'] = platform
            print('update %s to %s' % (os.path.basename(map_file), platform))
            with open(os.path.join(MAPS_ROOT, map_file), 'w') as f:
                f.write(json.dumps(map_json, indent=2))
                f.write('\n')
